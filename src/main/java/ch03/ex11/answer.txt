TODO: sort を一度しか呼ばれないような設計にする．